/*************************************************************************************
 + * Created By:  Jordan Pentaleri 
 + * This class is used to aid the QuickSalesSheet component in the SLP portal. 
 + * It loads a list of products, inserts a new Quick Sales Sheet Record, and returns
 + * the public url that is generated by the FileDeliveryHandler class. 
 + * 
 + * Tested By: SLPQuickSalesSheetTestclass
 + *************************************************************************************/


public without sharing class SLPQuickSalesSheetHandler{
    @AuraEnabled
    public static Quick_Sales_Sheet__c addNewQSS (Quick_Sales_Sheet__c newQSS) {
        newQSS.Generate_Doc__c = TRUE;
        insert newQSS;
        return newQSS;
    }

    @AuraEnabled
    public static List<Product2> getActiveProducts () {
        List<Product2> productList = [SELECT Id, Name 
                                      FROM Product2 
                                      WHERE Product_Type__c = 'Residential Loan'
                                      AND isActive = true
                                      ORDER BY State__c, Loan_Term__c];    
                                      
        return productList;   
    }

    @AuraEnabled
    public static Quick_Sales_Sheet__c getQuickSalesSheet (Id newlycreatedQSSid) {
        Quick_Sales_Sheet__c qss  = [   SELECT Link_to_File__c 
                                        FROM Quick_Sales_Sheet__c 
                                        WHERE Id = : newlycreatedQSSid Limit 1];

        return qss;
    }
    
}