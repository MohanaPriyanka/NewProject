<template>
    <!-- HEADER -->
    <div class="slds-box slds-theme_inverse slds-theme_alert-texture slds-grid slds-wrap">
        <div class="slds-size--3-of-3 slds-text-heading_medium">Transfer Sheet Reconciliation {titleSupplement}</div>
        <div class="slds-col slds-size--1-of-4 slds-p-bottom--medium slds-align--absolute-center">
            <c-bluewave-file-upload
              record-id={recordId}
              category-type={categoryTypeTransfer}
              accepted-file-types={fileTypes}
              onfileuploaded={refreshData}>
            </c-bluewave-file-upload>
        </div>
        <div class="slds-col slds-size--2-of-4">
            <div class="slds-align--absolute-center">
                <lightning-button-icon
                  icon-name="utility:sync"
                  variant="bare-inverse"
                  onclick={refreshData}
                  size="large"
                  class="slds-m-left_xx-small">
                </lightning-button-icon>
                <div class="slds-text-heading_small slds-p-left--small">Recalculate</div>
            </div>
        </div>
        <div class="slds-col slds-size--1-of-4 slds-align--absolute-center">
            <template if:true={allResolved}>
                <lightning-button
                  label="Insert UASBs"
                  title="Insert UASBs"
                  onclick={insertBills}>
                </lightning-button>
            </template>
        </div>
    </div>

    <!-- START TABLE SECTION -->
    <div class="slds-box slds-theme_shade slds-theme_alert-texture">
        <div class="slds-theme_default">
            <!-- START NON-UCB TRANSFER DATA -->
            <template if:false={UCB}>
                <!-- SECTION HEADERS -->
                <table>
                    <tr class="slds-p-around--medium">
                        <th class="slds-size--5-of-12 slds-theme_inverse">
                            <div class="slds-align--absolute-center">Bluewave Calculated</div>
                        </th>
                        <th class="slds-size--3-of-12 slds-theme_alt-inverse slds-theme_alert-texture">
                            <div class="slds-align--absolute-center">COMPARISON</div>
                        </th>
                        <th class="slds-size--4-of-12 slds-theme_inverse">
                            <div class="slds-align--absolute-center">Utility Transfer Sheet</div>
                        </th>
                    </tr>
                </table>
                <table>
                    <tr class="slds-theme_alt-inverse slds-theme_alert-texture">
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Customer Name</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Utility Number</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Production</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Credits</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Credit Value</th>
                        <th class="slds-size--2-of-12 slds-p-around--xx-small slds-align--absolute-center">Match Status</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Resolution</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Utility Number</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Production</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Credits</th>
                        <th class="slds-size--1-of-12 slds-p-around--xx-small">Credit Value</th>
                    </tr>
                    <template for:each={uasbData} for:item='item'>
                        <tr key={item.uniqueId} class={item.rowStyle}>
                            <td class={item.leftPanelStyle}>{item.customerName}</td>
                            <td class={item.leftPanelStyle}>{item.finaled}{item.sfUtilityAccount}</td>
                            <td class={item.leftPanelStyle}>{item.sfProduction}</td>
                            <td class={item.leftPanelStyle}>{item.sfCredits}</td>
                            <td class={item.leftPanelStyle}>{item.sfCreditValue}</td>
                            <!-- MATCHING ROW -->
                            <template if:true={item.isMatch}>
                                <td class="slds-p-around--xx-small slds-theme_success slds-align--absolute-center">
                                    MATCH
                                </td>
                                <td class="slds-p-around--xx-small slds-theme_success">Not Needed</td>
                            </template>
                            <!-- CREDIT MISMATCH ROW -->
                            <template if:true={item.isCreditMismatch}>
                                <td class="slds-p-around--xx-small slds-align--absolute-center">
                                    <lightning-helptext
                                      icon-name="utility:back"
                                      class= "slds-p-around--xx-small"
                                      content="Do you want to bill off transfer sheet or salesforce value?">
                                    </lightning-helptext>
                                    CREDIT_MISMATCH
                                    <lightning-helptext
                                      icon-name="utility:forward"
                                      class= "slds-p-around--xx-small"
                                      content="Do you want to bill off transfer sheet or salesforce value?">
                                    </lightning-helptext>
                                </td>
                                <td>
                                    <c-transfer-sheet-resolution
                                      default-value="UseUtility"
                                      record-number={item.uniqueId}
                                      onuseutility={utilityResolution}
                                      onusesalesforce={salesforceResolution}>
                                    </c-transfer-sheet-resolution>
                                </td>
                            </template>
                            <!-- MISSING BILL ROW -->
                            <template if:true={item.isMissingBill}>
                                <td class="slds-p-around--xx-small slds-align--absolute-center slds-theme_error">
                                    <lightning-helptext
                                      icon-name="utility:back"
                                      class= "slds-p-around--xx-small slds-theme_error"
                                      content="Will not send bill because there is not a SF account to link to">
                                    </lightning-helptext>
                                    MISSING_BILL
                                </td>
                                <td class="slds-p-around--xx-small slds-theme_error">
                                    Use Salesforce
                                </td>
                            </template>
                            <!-- MISSING TRANSFER ROW -->
                            <template if:true={item.isMissingTransfer}>
                                <td class="slds-p-around--xx-small slds-align--absolute-center slds-theme_error">
                                    MISSING_TRANSFER
                                    <lightning-helptext
                                      icon-name="utility:forward"
                                      class= "slds-p-around--xx-small slds-theme_error"
                                      content={missingTransferHelptext}>
                                    </lightning-helptext>
                                </td>
                                <td>
                                    <c-transfer-sheet-resolution
                                      record-number={item.uniqueId}
                                      onuseutility={utilityResolution}
                                      onusesalesforce={salesforceResolution}>
                                    </c-transfer-sheet-resolution>
                                </td>
                            </template>
                            <td class={item.rightPanelStyle}>{item.trUtilityAccount}</td>
                            <td class={item.rightPanelStyle}>{item.trProduction}</td>
                            <td class={item.rightPanelStyle}>{item.trCredits}</td>
                            <td class={item.rightPanelStyle}>{item.trCreditValue}</td>
                        </tr>
                    </template>
                </table>
            </template>
            <!-- END NON-UCB TRANSFER DATA -->

            <!--- START UCB TRANSFER DATA --->
            <template if:true={UCB}>
                <!-- NOTE: TO BE WORKED ON IN SUBSEQUENT WORK REQUEST -->
            </template>
            <!-- END UCB TRANSFER DATA -->
        </div>
    </div>
    <!-- END TABLE SECTION -->

    <!-- LOADING SPINNER -->
    <template if:false={readyState}>
        <c-bluewave-spinner show="true" fade-in="true" spinner-message="Loading..."></c-bluewave-spinner>
    </template>
</template>