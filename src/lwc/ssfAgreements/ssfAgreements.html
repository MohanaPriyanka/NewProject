<!--
 - Created by PeterYao on 2/24/2020.
 -->

<!-- Simple Signup Form Agreements -->
<template>
    <div class="slds-var-p-around_medium slds-text-align_center slds-text-heading_large">
      Agree
    </div>
  <div class="slds-var-m-around_small">
    <p class="small">Click the hyperlinks below to view your community solar agreements:</p>
  </div>
  <div class="slds-var-m-around_medium">
    <template iterator:it={contractDocuments}>
      <p key={it.value.id}>
          <a key={it.value.id} href="javascript:void(0);">
            <span style="color:blue" key={it.value.id} data-id={it.value.id} onclick={filePreview}>{it.value.title}</span>
          </a>
      </p>
    </template>
  </div>
  <template if:true={showContractDocument}>
    <div style="position:fixed;width:100%;height:100%;z-index: 2;top:0;left:0;background-color: rgba(0,0,0,0.5)">
      <div>
        <p class="slds-text-color_inverse">
            FOR PREVIEW ONLY<br/>Click "Close" to return to the agree page for signature.
        </p>
        <lightning-button label="Close" onclick={hideContractDocument}></lightning-button>
      </div>
      <div style="height: 100%">
        <iframe style="width:100%;height:100%" title="Contract" id="contract_iframe" src={documentUrl}></iframe>
      </div>
    </div>
  </template>
  <div class="slds-var-m-around_small">
    <p class="small">Click the checkboxes below to sign your agreements:</p>
  </div>
  <div style="background-color:#f3f3f3" class="slds-var-p-around_small">
    <template if:true={showDisclosures}>
      <p class="slds-var-m-around_small">
        <lightning-input name="disclosures" type="checkbox" checked={disclosures} label="Check to Consent to Electronic Disclosures" onchange={disclosureChecked}></lightning-input>
      </p>
      <p class="small slds-var-m-around_small">
        {disclosureLanguageFirstSegment}<b><a target="_blank" rel="noopener noreferrer" style="color:blue" href={esignDisclosureUrl}>ESIGN Consent Disclosure</a></b>{disclosureLanguageSecondSegment}
      </p>
    </template>
    <template if:true={renderCreditCheckLanguage}>
      <template if:true={showCreditCheck}>
        <p class="small slds-var-m-around_small">
          <lightning-input name="creditCheck" checked={creditCheck} type="checkbox" label={creditCheckLabel} onchange={creditCheckChecked}></lightning-input>
        </p>
        <template if:true={isFicoUnderwriting}>
          <p class="small slds-var-m-around_small">
            {ficoLanguageFirstSegment}
            <template if:true={moreCreditCheck}>
              {ficoLanguageSecondSegment} <span onclick={showLessCreditCheck} style="text-decoration:underline;color:blue">[Show less]</span>
            </template>
            <template if:false={moreCreditCheck}>
              ... <span onclick={showMoreCreditCheck} style="text-decoration:underline;color:blue">[Show more]</span>
            </template>
          </p>
        </template>
        <template if:true={isFinDocsUnderwriting}>
          <p class="small slds-var-m-around_small">
            {finDocsLanguageFirstSegment}
            <template if:true={moreCreditCheck}>
              {finDocsLanguageSecondSegment} <span onclick={showLessCreditCheck} style="text-decoration:underline;color:#0000ff">[Show less]</span>
            </template>
            <template if:false={moreCreditCheck}>
              ... <span onclick={showMoreCreditCheck} style="text-decoration:underline;color:blue">[Show more]</span>
            </template>
          </p>
        </template>
        <template if:true={isUtilityDataConsentOnly}>
          <p class="small slds-var-m-around_small">
            {utilityDataReviewLanguage}
          </p>
        </template>
      </template>
    </template>
    <template if:true={showCSAgreement}>
      <p class="small slds-var-m-around_small">
        <lightning-input name="csAgreement" checked={csAgreement} type="checkbox" label="Check to Sign Community Solar Agreement and CS Disclosure" onchange={csAgreementChecked}></lightning-input>
      </p>
      <p class="small slds-var-m-around_small">
        <span>{agreementLanguageFirstSegment}</span>
        <template iterator:it={contractDocuments}>
            <span key={it.value.id}>
                <template if:false={it.value.first}> and </template>
                <b><a key={it.value.id} href="javascript:void(0);">
                    <span style="color:blue" key={it.value.id} data-id={it.value.id} onclick={filePreview}>{it.value.title}</span>
                </a></b>
            </span>
        </template>
        <span> as well as BlueWave's <b><a target="_blank" rel="noopener noreferrer" style="color:blue" href="https://bluewavesolar.com/privacy-policy">Privacy Policy</a></b>. {agreementLanguageSecondSegment}</span>
        <template if:true={moreCSAgreement}>
          {agreementLanguageThirdSegment} <span onclick={showLessCSAgreement} style="text-decoration:underline;color:blue">[Show less]</span>
        </template>
        <template if:false={moreCSAgreement}>
          ... <span onclick={showMoreCSAgreement} style="text-decoration:underline;color:blue" data-target-id="agreement">[Show more]</span>
        </template>
      </p>
    </template>
    <div class="slds-grid slds-wrap">
      <div class="slds-size_1-of-3">
      </div>
      <div class="slds-size_1-of-3">
        <div class="slds-grid slds-wrap">
          <div class="slds-size_1-of-3 slds-align_absolute-center" onclick={showDisclosureApproval}>
            <lightning-icon icon-name={disclosureIcon} alternative-text="Preview" size="x-small"></lightning-icon>
          </div>
          <template if:true={renderCreditCheckLanguage}>
            <div class="slds-size_1-of-3 slds-align_absolute-center" onclick={showCreditCheckApproval}>
              <lightning-icon icon-name={creditCheckIcon} alternative-text="Preview" size="x-small"></lightning-icon>
            </div>
          </template>
          <div class="slds-size_1-of-3 slds-align_absolute-center" onclick={showCSAgreementApproval}>
            <lightning-icon icon-name={csAgreementIcon} alternative-text="Preview" size="x-small"></lightning-icon>
          </div>
        </div>
      </div>
      <div class="slds-size_1-of-3">
      </div>
    </div>
  </div>
  <p class="slds-var-m-around_small" onkeyup={checkForSubmit}>
    <lightning-input
      data-id="consentEmail"
      name="consentEmail"
      value={consentEmail}
      type="email"
      label="Confirm Email to Sign:"
      required
      onchange={genericOnChange}>
    </lightning-input>
  </p>
  <div class="slds-grid">
    <div class="slds-size_1-of-2">
      <button class="btn-inverse slds-var-m-around_small slds-float_left" onclick={handleBackButton}>Back</button>
    </div>
    <div class="slds-size_1-of-2">
      <button class="btn slds-var-m-around_small slds-float_right" onclick={continueAgreement}>{continueButtonLabel}</button>
    </div>
  </div>
</template>