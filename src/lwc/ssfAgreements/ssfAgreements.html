<!--
 - Created by PeterYao on 2/24/2020.
 -->

<!-- Simple Signup Form Agreements -->
<template>
  <h1 class="slds-text-align--center"><b>The subscriber must complete this page themselves.</b></h1>
  <div class="slds-m-around--small">
    Click to view documents:
  </div>
  <div class="slds-m-around--medium">
    <template iterator:it={contractDocuments}>
      <p key={it.value.ContentDocumentId}>
        <a key={it.value.ContentDocumentId} href="javascript:void(0);">
          <span style="color:blue" key={it.value.ContentDocumentId} data-id={it.value.ContentDocumentId} onclick={filePreview}>{it.value.ContentDocument.LatestPublishedVersion.Title}</span>
        </a>
      </p>
    </template>
  </div>
  <template if:true={showContractDocument}>
    <div style="position:fixed;width:100%;height:100%;z-index: 2;top:0;left:0;background-color: rgba(0,0,0,0.5)">
      <div>
        <lightning-button label="Close" onclick={hideContractDocument}></lightning-button>
      </div>
      <div style="height: 100%">
        <iframe style="width:100%;height:100%" title="Contract" src={documentUrl}></iframe>
      </div>
    </div>
  </template>

  <div style="background-color:#f3f3f3" class="slds-p-around--small">
    <template if:true={showDisclosures}>
      <p class="slds-m-around--small">
        <lightning-input name="disclosures" type="checkbox" checked={disclosures} label="Check to Consent to Electronic Disclosures" onchange={disclosureChecked}></lightning-input>
      </p>
      <p class="slds-m-around--small">
        By checking this box, entering my email address in the Email field below, and clicking the "Continue" button, I acknowledge that I have reviewed and agree to the BlueWave <b><a target="_blank" rel="noopener noreferrer" style="color:blue" href="https://bluewavesolar.my.salesforce.com/sfc/p/j0000001q7GO/a/0a000000MkFk/pvivOEszT68vNzlruWfakqXulDdStUlPcwN5oAm70aA">ESIGN Consent Disclosure</a></b> and consent to receive electronic disclosures. The device I will use to receive and access electronic disclosures meets the hardware and software requirements described in the ESIGN Consent Disclosure.
      </p>

    </template>
    <template if:true={showCreditCheck}>
      <p class="slds-m-around--small">
        <lightning-input name="creditCheck" checked={creditCheck} type="checkbox" label="Check to Authorize Credit and Utility Billing Review" onchange={creditCheckChecked}></lightning-input>
      </p>
      <p class="slds-m-around--small">
        By checking this box, and clicking the "Continue" button, I am granting BlueWave permission to perform a soft pull of my credit history (which will NOT impact my credit score) and to access my electric utility billing history, and to use my credit history and my electric utility billing history to process my application and for any other lawful purpose, signature is subject to the additional terms and conditions described here
        <template if:true={moreCreditCheck}>
          <span>. I understand that by entering my email address in the Email field below and pressing the "Continue" button, I am providing my electronic signature and signing an electronic record that will be my written instructions to obtain my credit history. I understand that if I ask BlueWave whether it checked my credit, BlueWave will tell me, and if it did, provide the name and address of the consumer reporting agency that provided the information.</span>
          <span onclick={showLessCreditCheck} style="text-decoration:underline;color:blue">[Show less]</span>
        </template>
        <template if:false={moreCreditCheck}>
          ... <span onclick={showMoreCreditCheck} style="text-decoration:underline;color:blue">[Show more]</span>
        </template>
      </p>
    </template>
    <template if:true={showCSAgreement}>
      <p class="slds-m-around--small">
        <lightning-input name="csAgreement" checked={csAgreement} type="checkbox" label="Check to Sign Community Solar Agreement and CS Disclosure" onchange={csAgreementChecked}></lightning-input>
      </p>
      <p class="slds-m-around--small">
        By checking this box, entering my email address in the Email field below, and clicking the "Continue" button, I acknowledge that I have reviewed and agree to the <b><a href="javascript:void(0);"><span style="color:blue" data-id={csAgreementDocumentId} onclick={filePreview}>Community Solar Agreement</span></a></b> and <b><a href="javascript:void(0);"><span style="color:blue" data-id={disclosureDocumentId} onclick={filePreview}>Solar Disclosure Form</span></a></b> as well as BlueWave's <b><a target="_blank" rel="noopener noreferrer" style="color:blue" href="https://bluewavesolar.com/privacy-policy">Privacy Policy</a></b>. I understand that by doing so, I am providing my electronic signature and signing the agreements linked above as electronic records, signature is subject to the additional terms and conditions described here
        <template if:true={moreCSAgreement}>
          <span>. I am also granting BlueWave permission to contact me via the phone number provided on this application. I also acknowledge that this is an application only and consummation of this transaction does not occur upon the placement of my electronic signature on this contract; rather consummation occurs (meaning that there is an executed agreement between BlueWave and me) after BlueWave verifies my eligibility, approves the document that I have electronically signed, and returns the contract to me with its countersignature.</span>
          <span onclick={showLessCSAgreement} style="text-decoration:underline;color:blue">[Show less]</span>
        </template>
        <template if:false={moreCSAgreement}>
          ... <span onclick={showMoreCSAgreement} style="text-decoration:underline;color:blue" data-target-id="agreement">[Show more]</span>
        </template>
      </p>
    </template>

    <div class="slds-grid slds-wrap">
      <div class="slds-size--1-of-3">
      </div>
      <div class="slds-size--1-of-3">
        <div class="slds-grid slds-wrap">
          <div class="slds-size--1-of-3 slds-align--absolute-center" onclick={showDisclosureApproval}>
            <lightning-icon icon-name={disclosureIcon} alternative-text="Preview" size="x-small"></lightning-icon>
          </div>
          <div class="slds-size--1-of-3 slds-align--absolute-center" onclick={showCreditCheckApproval}>
            <lightning-icon icon-name={creditCheckIcon} alternative-text="Preview" size="x-small"></lightning-icon>
          </div>
          <div class="slds-size--1-of-3 slds-align--absolute-center" onclick={showCSAgreementApproval}>
            <lightning-icon icon-name={csAgreementIcon} alternative-text="Preview" size="x-small"></lightning-icon>
          </div>
        </div>
      </div>
      <div class="slds-size--1-of-3">
      </div>
    </div>
  </div>

  <p class="slds-m-around--small">
    <lightning-input name="consentEmail" value={consentEmail} type="email" label="Confirm Email to Sign:" onchange={genericOnChange}></lightning-input>
  </p>
  <p class="slds-m-around--small">
    <lightning-button label="Continue" onclick={continueAgreement}></lightning-button>
  </p>

  <c-bluewave-spinner spinner-message={spinnerMessage} show={showSpinner}></c-bluewave-spinner>
</template>