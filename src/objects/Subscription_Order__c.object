<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <fields>
        <fullName>Approved_Change_in_Percent_Share__c</fullName>
        <description>Stamped with &apos;Calculated Change in % Share&apos; when Approved. If type = &apos;SSS Update,&apos; stamped with value of &apos;System Change Percent Share&apos; - &apos;Previous % Share.&apos; We need a static field for tracking purposes and to use in Rollup summary fields .</description>
        <externalId>false</externalId>
        <inlineHelpText>Stamped with &apos;Calculated Change in % Share&apos; when Approved. If type = &apos;SSS Update,&apos; stamped with value of &apos;System Change Percent Share&apos; - &apos;Previous % Share.&apos; We need a static field for tracking purposes and to use in Rollup summary fields .</inlineHelpText>
        <label>Approved Change in Percent Share</label>
        <precision>18</precision>
        <required>false</required>
        <scale>5</scale>
        <trackHistory>true</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Percent</type>
    </fields>
    <fields>
        <fullName>Approved_Change_in_Subscription__c</fullName>
        <description>This is the net change in kW DC. When SO is approved, field is stamped with &apos;Calculated Change in Subscription kW DC.&apos; If Type = &apos;SSS Update,&apos; field is stamped with value of &apos;System Change in kW Subscription&apos; - &apos;Previous kW Subscription. It&apos;s important to have a static value for tracking purposes, and to use in rollup summary fields.</description>
        <externalId>false</externalId>
        <inlineHelpText>This is the net change in kW DC. When SO is approved, field is stamped with &apos;Calculated Change in Subscription kW DC.&apos; If Type = &apos;SSS Update,&apos; field is stamped with value of &apos;System Change in kW Subscription&apos; - &apos;Previous kW Subscription. It&apos;s important to</inlineHelpText>
        <label>Approved Change in Subscription (KW DC)</label>
        <precision>18</precision>
        <required>false</required>
        <scale>4</scale>
        <trackHistory>true</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>System_Change_Percent_Share_of_System__c</fullName>
        <externalId>false</externalId>
        <formula>ROUND( Previous_kw_DC_Subscription__c / Total_System_Size_kW_DC__c , Utility_Number_of_Decimal_Places__c + 2)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>System Change Percent Share of System</label>
        <precision>18</precision>
        <required>false</required>
        <scale>5</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Percent</type>
    </fields>
    <fields>
        <fullName>System_Change_kW_DC_Subscription__c</fullName>
        <externalId>false</externalId>
        <formula>ROUND(  Previous_kw_DC_Subscription__c / Total_System_Size_kW_DC__c , Utility_Number_of_Decimal_Places__c + 2)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>System Change kW DC Subscription</label>
        <precision>18</precision>
        <required>false</required>
        <scale>5</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Percent</type>
    </fields>
    <fields>
        <fullName>Type__c</fullName>
        <externalId>false</externalId>
        <label>Type</label>
        <required>false</required>
        <trackHistory>true</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <restricted>true</restricted>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>Transfer</fullName>
                    <default>false</default>
                    <label>Transfer</label>
                </value>
                <value>
                    <fullName>Cancellation</fullName>
                    <default>false</default>
                    <label>Cancellation</label>
                </value>
                <value>
                    <fullName>Shared Solar System Update</fullName>
                    <default>false</default>
                    <label>Shared Solar System Update</label>
                </value>
                <value>
                    <fullName>Resize</fullName>
                    <default>false</default>
                    <label>Resize</label>
                </value>
                <value>
                    <fullName>Initial</fullName>
                    <default>false</default>
                    <label>Initial</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <validationRules>
        <fullName>Lock_Approved_SOs</fullName>
        <active>true</active>
        <errorConditionFormula>AND(
OR(
ISPICKVAL(Approval_Status__c,&quot;Approved&quot;),
ISPICKVAL(Approval_Status__c,&quot;&quot;)
),
/* Prevents changing the approval status once it&apos;s been set to approved, but still allowing it to be set to approved.*/

PRIORVALUE(Approval_Status__c)!=&quot;&quot;,
ISNEW()=false, 
/* Allows APEX to stamp the Approved values.*/
ISBLANK(Approved_Change_in_Subscription__c), 
ISBLANK(Approved_Change_in_Percent_Share__c)
)
/* Prevents changing the approval status once it&apos;s been set to approved.*/</errorConditionFormula>
        <errorDisplayField>Approval_Status__c</errorDisplayField>
        <errorMessage>Once a Subscription Order is Approved, it cannot be edited. To update a customers subscription, please log a new Subscription Order.</errorMessage>
    </validationRules>
</CustomObject>