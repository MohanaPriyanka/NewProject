<aura:component controller="CAPController" access="global" extends="c:CAPParent">
  <aura:attribute name="leadId" type="String"/>
  <aura:attribute name="leadEmail" type="String"/>
  <aura:set attribute="STAGENAME" value="NAV_Getting_Started"/>
  <aura:handler event="c:CAPNavigationEvent" action="{!c.handleNavEvent}"/>
  <aura:registerEvent name="CAPNavigationEvent" type="c:CAPNavigationEvent"/>

  <!-- LOGIN FORM -->
  <aura:if isTrue="{!v.page == 'Login'}">
    <div class="slds-col slds-col--padded slds-p-top--small">
      <form class="slds-form--stacked" aura:id="form" action="javascript: return false">
        <div class="slds-form-element slds-is-required">
          <div class="slds-form-element__control">
            {!$Label.c.START_Email_Confirmation_Instruction}
            <ui:inputEmail aura:id="leadEmail"
                             placeholder="yourname@email.com"
                             class="slds-input slds-p-top-small"
                             value="{!v.leadEmail}"
                             updateOn="keydown,change"
                             keydown="{!c.checkForEnter}"/>
          </div>
        </div>
        <div class="slds-form-element__row slds-p-top--small">
          <lightning:button aura:id="loginButton" label="Submit" onclick="{!c.login}"/>
        </div>
      </form>
    </div>
  </aura:if>
  <!-- / LOGIN FORM -->

  <!-- CONFIRMATION -->
  <aura:if isTrue="{!v.page == 'LoanConfirmation'}">
    <div class="slds-col slds-col--padded slds-p-top--small">
      <div class="slds-text-heading--medium">
        <b>{!$Label.c.START_Lets_Get_Started}</b>
      </div>
      <div class="slds-form slds-form_compound slds-p-top--large">
        <div class="slds-form-element__group">
          <div class="slds-form-element__row">
            <div class="slds-form-element slds-size_1-of-1">
              <lightning:input type="number"
                               formatter="currency" 
                               label="System Cost" 
                               value="{!v.lead.System_Cost__c}" 
                               disabled="true">
              </lightning:input>
            </div>
          </div>
          <div class="slds-form-element__row">
            <div class="slds-form-element slds-size_1-of-1">
              <lightning:input type="number"
                               formatter="currency" 
                               label="Down Payment" 
                               value="{!v.lead.System_Cost__c - v.lead.Requested_Loan_Amount__c}" 
                               disabled="true">
              </lightning:input>
            </div>
          </div>
          <div class="slds-form-element__row">
            <div class="slds-form-element slds-size_1-of-1">
              <lightning:input type="number"
                               formatter="currency" 
                               label="Requested Loan Amount" 
                               value="{!v.lead.Requested_Loan_Amount__c}" 
                               disabled="true">
              </lightning:input>
            </div>
          </div>
        </div>
        <div class="slds-form-element__row slds-p-top--small">
          <lightning:button aura:id="confirmSubmit" label="Next" onclick="{!c.confirmLoan}"/>
        </div>
      </div>
    </div>
  </aura:if>
  <!-- / CONFIRMATION -->

  <!-- DISCLAIMER -->
  <aura:if isTrue="{!v.page == 'LoanDisclaimer'}">
    <div class="slds-col slds-col--padded">
      <p class="slds-p-left--large slds-text-body--large">
        <aura:if isTrue="{!v.lead.Product_Program__c == 'MSLP'}">
          {!$Label.c.START_Disclosure_PreQual_MSLP}
          <aura:set attribute="else">
            {!$Label.c.START_Disclosure_PreQual}
          </aura:set>
        </aura:if>
      </p>

      <aura:if isTrue="{!v.lead.LASERCA__Home_State__c == 'MA'}">
        <p class="slds-p-left--large slds-p-top--small slds-text-body--large">
          <aura:if isTrue="{!v.lead.Product_Program__c == 'MSLP'}">
            {!$Label.c.START_Disclosure_MSLP_SREC}
            <aura:set attribute="else">
              {!$Label.c.START_Disclosure_MA_SREC}
            </aura:set>
          </aura:if>
        </p>
      </aura:if>

      <p class="slds-p-left--large slds-p-top--small slds-text-body--large">
        <aura:if isTrue="{!v.lead.Product_Program__c == 'MSLP'}">
          {!$Label.c.START_Disclosure_Income_Doc_MSLP}
          <aura:set attribute="else">
            {!$Label.c.START_Disclosure_Income_Doc}
          </aura:set>
        </aura:if>
      </p>
      <div class="slds-form-element__row slds-m-top--medium">
        <lightning:button aura:id="confirmDisclaimer" label="Next" onclick="{!c.finishStage}"/>
      </div>
    </div>
  </aura:if>
  <!-- / DISCLAIMER -->
</aura:component>
