<aura:component implements="forceCommunity:availableForAllPageTypes" controller="SLPCustomerHandler" access="global">
    <aura:attribute name="loanList" type="Object"  /> 
    <aura:attribute name="customer" type="Object"  />
    <aura:attribute name="customerInformation" type="Object" />
	  <aura:attribute name="customerDates" type="String" />
    <aura:attribute name="taskType" type="String" access="global" />
    <aura:attribute name="parentSubTaskButton" type="Boolean"  />
    <aura:attribute name="licenseType" type="Boolean"  />      
    <aura:attribute name="partnerTaskList" type="Object"  />
    <aura:attribute name="parentSubTaskList" type="Object"  /> 
    <aura:attribute name="subTaskList" type="Object"  />
    <aura:attribute name="dateToggle" type="Boolean"  />
    <aura:attribute name="customerWindowLoanList" type="Object"  /> 
    <aura:attribute name="customerWindowTaskList" type="Object"  />  
	  <aura:attribute name="taskMap" type="Map"  />      
    <aura:attribute name="completeDisbursalList" type="Object"  />
    <aura:attribute name="incompleteDisbursalList" type="Object"  />    
    <aura:attribute name="taskViewButtonToggle" type="Boolean"  />
    <aura:attribute name="blueWaveReviewAlert" type="Boolean"  />     
	  <aura:registerEvent name="customerEvent" type="c:SLPCustomerEvent"/>    
    <aura:handler event="c:SLPDashboardEvent" action="{!c.openCustomerWindow}" />
    <aura:handler event="c:SLPAllCustomersEvent" action="{!c.openCustomerWindow}" />      
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />  
 	  <aura:handler name="change" value="{!v.customerInformation}" action="{!c.fieldChanges}"/>    
    <ltng:require styles="{!$Resource.animations}" />    
    
  <aura:attribute name="equipmentUpdate" type="Residential_Equipment__c" 
    default="{ 'sobjectType' : 'Residential_Equipment__c',
                'Name': '',
             	  'Generator_Nameplate_Capacity__c': '',
                'Type_of_Module__c': '',
                'Number_of_Modules__c': '',
                'Module_Manufacturer__c': '',
                'Module_Model_Number__c':'',
                'Type_of_Inverter__c': '',
                'Number_of_Inverters__c': '',
                'Inverter_Manufacturer__c': '',
                'Inverter_Model_Number__c': '',
                'Mechanical_Installation_Date__c': '',
                'Interconnection_Date__c': '',
             	  'Mechanically_Installed__c': '',
             	  'Interconnected__c':'',
                'SREC_Opt_In_Calendar_Quarter__c':'',
                'Commonwealth_Solar_Rebate_Program__c': '',   
                'Module_Power_Rating__c' : '',
                'Number_of_Modules__c' : '',
                'Module_Array_Mounting_Type__c' : '',
                'Module_Array_Azimuth__c' : '',
                'Module_Array_Tilt__c' : '',
                'Module_Mounting_Location__c' : '',
                'Inverter_Manufacturer__c' : '',
                'Number_of_Inverters__c' : '',
                'Inverter_Model_Number__c' : '',
                'Remote_Monitoring_System_Vendor__c' : '',
                'Remote_Monitorin_Systegm_Identifier__c' : '',
                'Number_of_Meters__c' : '',
                'Solar_Meter_Manufacturer__c' : '',
                'Solar_Meter_Model__c' : '',
                'Solar_Meter_Serial_Number__c' : '',
                'Initial_Solar_Meter_Reading__c' : '',
                'Initial_Solar_Meter_Reading_Date__c' : '',
                'CEC_Production_Tracking_System_ID_Number__c' : '',
                'PowerClerk_Application_ID__c' : '',
                'Estimated_On_Site_Behind_the_Meter_Load__c' : '',
                'Percentage_of_System_Shaded__c' : '',
                'Contract_Execution_Date__c' : '',
                'Generator_Installation_Date__c' : '',
                'Generator_Interconnection_Date__c' : '',
                'Generator_Energized_Online_Date__c' : '',
                'Generator_Type__c' : '',
                'Generator_Nameplate_Capacity__c' : '',
                'Annual_Production_kWh_kW__c' : ''                               
             }"/>
    <aura:attribute name="loanUpdate" type="Loan__c" 
    default="{ 'sobjectType' : 'Loan__c',
                 'Commencement_Datee__c': '',
             	   'System_Costt__c':'',
             }"/>      
     
<!-- main issues inclue the ability to break out subTasks within the task table. The tasks break out for each task with subTasks, filtering them by 
task type has been proven difficult due to sequence of the attribute's value after the loading of the subTasks and lock up of functionality 
when task is selected that doesn't equal the hard-coded value of task type. <Span> is also a solution that solves the framework error for 
accessing the attribute when unaccessible (this is a framework error) however it throws off the whole chart. The other issue is with regards to the 
view and canacel button. There is a rendering issue with making them dissapear and appear correctly. It only occurs when the task list is 
reloaded by clicking the view button on the dashboard page-->   
    
    <style>
        @font-face {
        font-family: proximaNovaFont;
        src: url('{!$Resource.ProximaNova}');
        }
        .proximaNova95 {
            font-family: proximaNovaFont;   
     		font-size:95%;
      		color: #FFFFFF;
        }

        @font-face {
        font-family: proximaNovaFont;
        src: url('{!$Resource.ProximaNova}');
        }
        .proximaNovaBrand {
            font-family: proximaNovaFont;   
        font-size:32px;
          color: #236192;
        }   

        @font-face {
        font-family: proximaNovaFont;
        src: url('{!$Resource.ProximaNova}');
        }
        .proximaNovaDataGreenSmall {
            font-family: proximaNovaFont;   
        font-size:100%;
          color: #32CD32;
        }

        @font-face {
        font-family: proximaNovaFont;
        src: url('{!$Resource.ProximaNova}');
        }
        .proximaNovaDataGreenSmall {
            font-family: proximaNovaFont;   
        font-size:100%;
          color: #32CD32;
        }

        @font-face {
        font-family: proximaNovaFont;
        src: url('{!$Resource.ProximaNova}');
        }
        .proximaNovaDataStream {
            font-family: proximaNovaFont;   
        font-size:100%;
          color: #00b2a9;
        }

        @font-face {
        font-family: proximaNovaFont;
        src: url('{!$Resource.ProximaNova}');
        }
        .proximaNovaDataBlue {
            font-family: proximaNovaFont;   
        font-size:90%;
          color: #266092;
        }  
        @font-face {
        font-family: proximaNovaFont;
        src: url('{!$Resource.ProximaNova}');
        }
        .proximaNovaWhite {
        font-family: proximaNovaFont;   
        font-size:200%;
        color: #FFFFFF;
        }       
    </style>
    
    <div aura:id = "customerPage" class="noDisplayBar"> 	
        <div aura:id="customerName" class="main2 proximaNovaBrand"> 
            <div  class="center proximaNovaBrand"><h1> {!v.customer.Loan__r.Name} </h1></div>
             <hr></hr>  
        </div>
        <br></br> 
          <!--  _________________________________PROGRESS BAR ___________________________________ -->   
        <div aura:id="taskBar" class="slds-wizard" role="navigation">    
          <ol class="slds-wizard__list">   
              <aura:iteration items="{!v.partnerTaskList}" var="task">    
              <aura:if isTrue="{!or(task.Status__c == 'Complete', task.Status__c == 'Pending')}">                  
                <li class="slds-wizard__item slds-is-active">
                      <span class="slds-wizard__marker "></span>
                      <span class="slds-wizard__label proximaNovaDataBlue slds-truncate" 
                            title="Navigation">{!task.Progress_Bar_Name__c}</span>
                  </li> 
                <aura:set attribute="else">      
                <li class="slds-wizard__item">
                      <span class="slds-wizard__marker "></span>
                      <span class="slds-wizard__label proximaNovaDataBlue slds-truncate" 
                            title="Navigation">{!task.Progress_Bar_Name__c}</span>
                </li>    
                </aura:set>
              </aura:if>               
              </aura:iteration>                                        
              </ol>
              <span class="slds-wizard__progress">
                <span aura:id="progressBar" class="slds-wizard__progress-bar"></span>
              </span>
            </div>
      	<div>
        <br></br>
        <br></br>
        <!--  _________________________________CUSTOMER INFO HEADER ___________________________________ -->                
        <table class="slds-table slds-table--bordered  slds-table--striped box">
          <thead>
            <tr class="slds-text-heading--label  proximaNovaDataBlue" >           
              <th scope="col"><span class="slds-truncate"><b>Partner</b></span></th>
              <th scope="col"><span class="slds-truncate"><b>Sales Agent</b></span></th>
              <th scope="col"><span class="slds-truncate"><b>Product</b></span></th>
              <th scope="col"><span class="slds-truncate"><b>System Cost</b></span></th>
              <aura:if isTrue="{!v.licenseType}">
                <th scope="col"><span class="slds-truncate"><b>Funded</b></span></th>
              </aura:if>
            </tr>
          </thead>
          <tbody>
              <tr>
                <th scope="row"> <b>{!v.customer.Loan__r.Partner__r.Name}</b> </th>
                <th scope="row"> <b>{!v.customer.Loan__r.Sales_Agent__r.Name}</b> </th>    
                <th scope="row"> <b>{!v.customer.Loan__r.Product__r.ProductCode}</b> </th>
                <th scope="row"> <ui:outputCurrency value="{!v.customer.Loan__r.System_Costt__c}" /></th> 
                <aura:if isTrue="{!v.licenseType}">   
                  <th scope="row"> <ui:outputCurrency class="proximaNovaDataStream" value="{!v.customer.Loan__r.Total_Funds_Disbursed__c}" /></th>
                </aura:if>                
              </tr>          
          </tbody>
        </table>  
        <br></br>      
        <!--  _________________________________INFORMATION BUTTONS ___________________________________ -->                
        <div aura:id = "customerInformationButtons" class="main2">        
            <br></br>
            <aura:if isTrue="{!v.licenseType}">  
            <div class="clearfix">               
                <div class="boxLeftExec">
                           <ui:button aura:id="taskInformationButton"
                               class="slds-button--brand box slds-align--absolute-center"
                               labelClass="proximaNova95"
                               label="View Task Information"                  
                               press="{!c.openTaskInformation}"/>                           
                </div>
                <div class="boxCenterExec">
                           <ui:button aura:id="customerInformationButton"
                               class="slds-button--brand box slds-align--absolute-center"
                               labelClass="proximaNova95"
                               label="View Customer Information"                  
                               press="{!c.openCustomerModal}"/>                           
                </div>           
                <div class="boxRightExec">
                           <ui:button aura:id="disbursalInformationButton"
                               class="slds-button--brand box slds-align--absolute-center"
                               labelClass="proximaNova95"
                               label="View Disbursal Information"                  
                               press="{!c.openDisbursalInformation}"/>                           
                </div>
            </div>
            <aura:set attribute="else">
            <div class="clearfix">               
                <div class="boxLeftUser">
                           <ui:button aura:id="taskInformationButton"
                               class="slds-button--brand box slds-align--absolute-center"
                               labelClass="proximaNova95"
                               label="View Task Information"                  
                               press="{!c.openTaskInformation}"/>                           
                </div>
                <div class="boxRightUser">
                           <ui:button aura:id="customerInformationButton"
                               class="slds-button--brand box slds-align--absolute-center"
                               labelClass="proximaNova95"
                               label="View Customer Information"                  
                               press="{!c.openCustomerInformation}"/>                           
                </div>           
            </div>              
            </aura:set>  
            </aura:if>            
        </div>
        <hr></hr> 
        <aura:if isTrue="{!v.blueWaveReviewAlert}">
          <h3> In some cases, the review stage may require BlueWave to reach out to borrowers to obtain sensitive information. Please be aware that this may take longer than the other stages. You will be notified when it is completed.</h3>
          <br></br>
        </aura:if>
        <aura:if isTrue="{!v.customer.Loan__r.DOER_Solar_Loann__c}">    
          <div aura:id="cusomterInformationTextMSLP" class="noDisplay paddingBottom1">
            <h3>  
              All relevant customer information has been, or will be provided through the MCEC Technical Application. Please update this customer's income documentation if you have not already done so and submit your sales agreement with the customer 
            </h3>
          </div>
        </aura:if>                                           
        <!--  _________________________________CUSTOMER INFORMATION ___________________________________ -->                
        
        <div aura:id = "customerInformation1" class="box noDisplay"> 
            <br></br>
            <fieldset>
                <div class="clearfix main2"> 
                <div class="slds-form-element__group">
                  <div class="slds-form-element__row"> 
                      <div class="salesAgreementButtonRight">
                           <ui:button aura:id="salesAgreementButton"
                               class=" box slds-align--absolute-center"
                               labelClass=""
                               label="Submit Sales Agreement"                  
                               press="{!c.navigateSalesAgreementDoc}"/>                           
                      </div>                             
                      <div class="documentsButtonLeft">
                           <ui:button aura:id="incomeDocsButton"
                               class=" box slds-align--absolute-center"
                               labelClass=""
                               label="Submit Income Documentation"                  
                               press="{!c.navigateIncomeDocs}"/>                           
                      </div>                          
                  </div>
                </div> 
                </div>
                <br></br>
            </fieldset>
            <aura:if isTrue="{!v.customer.Loan__r.DOER_Solar_Loann__c == false}">                  
            <fieldset class="slds-form--compound paddingTop1x5">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small ">
                    <label class="slds-form-element__label" for="input-03">System Cost</label>
                    <ui:outputCurrency aura:id="systemCost" class="slds-input" value="{!v.customerInformation.Loan__r.System_Costt__c}"/>          
                    </div> 
                  <div class="slds-form-element slds-p-horizontal--small ">
                    <label class="slds-form-element__label" for="input-03">Principal Value</label>
                    <ui:outputCurrency aura:id="principalValue" class="slds-input" value="{!v.customerInformation.Loan__r.Principal__c}"/>          
                    </div>        
                </div>
                </div>
            </fieldset>          
            <fieldset class="slds-form--compound">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">System Size</label>
                    <ui:inputNumber aura:id="systemSize" class="slds-input" value="{!v.equipmentUpdate.Generator_Nameplate_Capacity__c}" placeholder="{!v.customerInformation.Generator_Nameplate_Capacity__c}"/>          
                  </div>                    
                  <div class="slds-form-element slds-p-horizontal--small slds-grid--align-center ">
                    <label class="slds-form-element__label" for="input-03">Estimated Date of Completion</label>
                      <ui:inputDate aura:id="commencementDateChanger" 
                          class="slds-input" 
                          displayDatePicker="true"
                          value="{!v.customerInformation.Loan__r.Commencement_Datee__c}"                         
                      />       
                    </div>                     
                </div>
                </div>
            </fieldset>              
            <fieldset class="slds-form--compound">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Manufacturer</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Manufacturer__c}" placeholder="{!v.customerInformation.Module_Manufacturer__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Model Number/Type</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Model_Number__c}" placeholder="{!v.customerInformation.Module_Model_Number__c}"/>          
                  </div>                                       
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Number of Modules</label>
                    <ui:inputNumber aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Number_of_Modules__c}" placeholder="{!v.customerInformation.Number_of_Modules__c}" />          
                  </div>                     
                </div>
                </div>                 
            </fieldset>            
            <fieldset class="slds-form--compound">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Inverter Manufacturer</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Inverter_Manufacturer__c}" placeholder="{!v.customerInformation.Inverter_Manufacturer__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Inverter Model Number/Type</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Inverter_Model_Number__c}" placeholder="{!v.customerInformation.Inverter_Model_Number__c}"/>          
                  </div>                        
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Number of Inverters</label>
                    <ui:inputNumber aura:id="inverterNumber" class="slds-input" value="{!v.equipmentUpdate.Number_of_Inverters__c}" placeholder="{!v.customerInformation.Number_of_Inverters__c}" />          
                  </div>                  
                </div>
                </div>
            </fieldset>           
            <br></br>
              <div class="slds-align--absolute-center paddingBottom1 ">
                    <ui:button aura:id="saveEquipment" label="Save" class="slds-button slds-button--brand " press="{!c.saveEquipmentInformation}"></ui:button>   
                    </div> 
            </aura:if>                       
            </div>
            <aura:if isTrue="{!v.customer.Loan__r.DOER_Solar_Loann__c == false}">
            <div aura:id = "customerInformation2" class="box noDisplay">                           
            <hr></hr>
            <fieldset class="slds-form--compound ">
              <br></br>
                <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small slds-grid--align-center noDisplay">    
                  </div>              
                  <div class="slds-form-element slds-p-horizontal--small slds-grid--align-center ">
                    <label class="slds-form-element__label" for="input-03">Mechanical Installation Date</label>
                      <ui:inputDate aura:id="MechInstallDate" 
                          class="slds-input" 
                          displayDatePicker="true"
                          value="{!v.customerInformation.Mechanical_Installation_Date__c}"                         
                      />       
                    </div>

                      <div class="documentsButtonRight">
                           <ui:button aura:id="mechInstallDocsButton"
                               class=" box "
                               labelClass=""
                               label="Submit Installation Documentation"                  
                               press="{!c.navigateInstallationDocs}"/>                           
                      </div>                                            
                  </div>                         
                  <div class="slds-form-element__row">                     
                  <div class="slds-form-element slds-p-horizontal--small slds-grid--align-center ">
                    <label class="slds-form-element__label" for="input-03">Interconnection Date</label>
                      <ui:inputDate aura:id="interconnectionDateChanger" 
                          class="slds-input" 
                          displayDatePicker="true"
                          value="{!v.customerInformation.Interconnection_Date__c}"                         
                      />       
                    </div>  

                      <div class="documentsButtonRight">
                           <ui:button aura:id="interconnectDocsButton"
                               class=" box"
                               labelClass=""
                               label="Submit Interconnection Documentation"                  
                               press="{!c.navigateInterconnectionDocs}"/>                           
                      </div>                                           
                </div>
                </div>
                </fieldset>             
            	<div class="slds-align--absolute-center paddingBottom1 ">
                    <ui:button label="Save" class="slds-button slds-button--brand " press="{!c.saveEquipmentInformation}"></ui:button>
				</div>
        </div>
        </aura:if>   
        <!--  _________________________________Customer Information Modals ___________________________________ -->    
        <div aura:id="generalSystemInformationModal" role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal  slds-modal--large">
          <div  class="slds-modal__container ">
            <div class="slds-modal__header blueBackground">
              <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close">
                <span class="slds-assistive-text">Close</span>
              </button>
              <h2 id="header43" class="slds-text-heading--medium proximaNovaWhite">{!v.customer.Loan__r.Name}</h2>
            </div>
            <div class="slds-modal__content slds-p-around--medium">
              <fieldset class="slds-form--compound paddingTop1x5">
                <div class="slds-form-element__group">
                  <div class="slds-form-element__row">
                    <div class="slds-form-element slds-p-horizontal--small ">
                      <label class="slds-form-element__label" for="input-03">System Cost</label>
                      <ui:outputCurrency aura:id="systemCost" class="slds-input" value="{!v.customerInformation.Loan__r.System_Costt__c}"/>          
                    </div> 
                    <div class="slds-form-element slds-p-horizontal--small ">
                      <label class="slds-form-element__label" for="input-03">Principal Value</label>
                      <ui:outputCurrency aura:id="principalValue" class="slds-input" value="{!v.customerInformation.Loan__r.Principal__c}"/>          
                    </div>        
                  </div>
                </div>
              </fieldset>          
              <fieldset class="slds-form--compound">
                <div class="slds-form-element__group">
                  <div class="slds-form-element__row">
                    <div class="slds-form-element slds-p-horizontal--small">
                      <label class="slds-form-element__label" for="input-03">System Size</label>
                      <ui:inputNumber aura:id="systemSize" class="slds-input" value="{!v.equipmentUpdate.Generator_Nameplate_Capacity__c}" placeholder="{!v.customerInformation.Generator_Nameplate_Capacity__c}"/>          
                    </div>                    
                    <div class="slds-form-element slds-p-horizontal--small slds-grid--align-center ">
                      <label class="slds-form-element__label" for="input-03">Estimated Date of Completion</label>
                      <ui:inputDate aura:id="commencementDateChanger" 
                        class="slds-input" 
                        displayDatePicker="true"
                        value="{!v.customerInformation.Loan__r.Commencement_Datee__c}"                         
                        />       
                      </div>                     
                    </div>
                  </div>
                </fieldset>                  
                <fieldset class="slds-form--compound">
                  <div class="slds-form-element__group">
                    <div class="slds-form-element__row">
                      <div class="slds-form-element slds-p-horizontal--small">
                        <label class="slds-form-element__label" for="input-03">Module Manufacturer</label>
                        <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Manufacturer__c}" placeholder="{!v.customerInformation.Module_Manufacturer__c}"/>          
                      </div>  
                      <div class="slds-form-element slds-p-horizontal--small">
                        <label class="slds-form-element__label" for="input-03">Module Model Number/Type</label>
                        <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Model_Number__c}" placeholder="{!v.customerInformation.Module_Model_Number__c}"/>          
                      </div>                                       
                      <div class="slds-form-element slds-p-horizontal--small">
                        <label class="slds-form-element__label" for="input-03">Number of Modules</label>
                        <ui:inputNumber aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Number_of_Modules__c}" placeholder="{!v.customerInformation.Number_of_Modules__c}" />          
                      </div>                     
                    </div>
                  </div>                 
                </fieldset>            
                <fieldset class="slds-form--compound">
                  <div class="slds-form-element__group">
                    <div class="slds-form-element__row">
                      <div class="slds-form-element slds-p-horizontal--small">
                        <label class="slds-form-element__label" for="input-03">Inverter Manufacturer</label>
                        <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Inverter_Manufacturer__c}" placeholder="{!v.customerInformation.Inverter_Manufacturer__c}"/>          
                      </div>  
                      <div class="slds-form-element slds-p-horizontal--small">
                        <label class="slds-form-element__label" for="input-03">Inverter Model Number/Type</label>
                        <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Inverter_Model_Number__c}" placeholder="{!v.customerInformation.Inverter_Model_Number__c}"/>          
                      </div>                        
                      <div class="slds-form-element slds-p-horizontal--small">
                        <label class="slds-form-element__label" for="input-03">Number of Inverters</label>
                        <ui:inputNumber aura:id="inverterNumber" class="slds-input" value="{!v.equipmentUpdate.Number_of_Inverters__c}" placeholder="{!v.customerInformation.Number_of_Inverters__c}" />          
                      </div>                  
                    </div>
                  </div>
                </fieldset>  
              </div>
              <div class="slds-modal__footer">
                <lightning:button aura:id="closeCustomerModalButton" class="slds-button " onclick="{!c.closeCustomerModal}" label="Close"></lightning:button>
                <lightning:button aura:id="saveCustomerModalButton" class="slds-button slds-button--brand" onclick="{!c.saveEquipmentInformation}" label="Save"></lightning:button>
                <ui:spinner aura:id="emailSpinner" class="floatRight" isVisible="false"/>            
              </div>
            </div>
          </div>
        <div aura:id="srecInformationModal" role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal  slds-modal--large">
          <div  class="slds-modal__container ">
            <div class="slds-modal__header blueBackground">
              <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close">
                <span class="slds-assistive-text">Close</span>
              </button>
              <h2 id="header43" class="slds-text-heading--medium proximaNovaWhite">{!v.customer.Loan__r.Name}</h2>
            </div>
            <div class="slds-modal__content slds-p-around--medium">
            <div aura:id="SrecInterconnectionPage">            
            <fieldset>           
              <legend class="slds-form-element__legend slds-form-element__label">SREC Opt-in Calendar Quarter</legend>
              <div class="slds-form-element__control">
                <div class="slds-radio--button-group">
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="radio" id="Q1 2017" aura:id="Q1 2017" value="Q1 2017"  onclick="{!c.setSrecOptInCalendarQuarter}"/>          
                    <label class="slds-radio--button__label" for="Q1 2017">
                      <span class="slds-radio--faux">Q1' 2017</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="radio" id="Q22017" label="cole" aura:id="Q22017" value="Q22017" onclick="{!c.setSrecOptInCalendarQuarter}"/>
                    <label class="slds-radio--button__label" for="Q22017">
                      <span class="slds-radio--faux">Q2' 2017</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="radio" id="Q3 2017" aura:id="Q3 2017" value="Q3 2017" onclick="{!c.setSrecOptInCalendarQuarter}" />
                    <label class="slds-radio--button__label" for="Q3 2017">
                      <span class="slds-radio--faux">Q3' 2017</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="radio" id="Q4 2017" aura:id="Q4 2017" value="Q4 2017" onclick="{!c.setSrecOptInCalendarQuarter}" />
                    <label class="slds-radio--button__label" for="Q4 2017">
                      <span class="slds-radio--faux">Q4' 2017</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="radio" id="Q1 2018" aura:id="Q1 2018" value="Q1 2018" onclick="{!c.setSrecOptInCalendarQuarter}" />
                    <label class="slds-radio--button__label" for="Q1 2018">
                      <span class="slds-radio--faux">Q1' 2018</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="radio" id="Q2 2018" aura:id="Q2 2018" value="Q2 2018" onclick="{!c.setSrecOptInCalendarQuarter}" />
                    <label class="slds-radio--button__label" for="Q2 2018">
                      <span class="slds-radio--faux">Q2' 2018</span>
                    </label>
                  </span>                  
                </div>
              </div>
            </fieldset>  
            <br></br>
            <fieldset class="slds-form-element">
            <div class="slds-form-element slds-p-horizontal--small">
              <label class="slds-checkbox--toggle slds-grid">
                <label class="slds-form-element__label" for="SrecInterConnectionToggle">Is this system interconnected and operating?</label>
                
                <ui:inputCheckbox name="SrecInterConnectionToggle" 
                                  value="{!v.customerInformation.Interconnected__c }" 
                                  change="{!c.setEquipmentAsInterconnected}"/>
                  <span id="toggle-desc" class="slds-checkbox--faux_container " aria-live="assertive">
                  <span class="slds-checkbox--faux"></span>
                  <span class="slds-checkbox--on">Yes</span>
                  <span class="slds-checkbox--off">No</span>
                </span>
              </label>
            </div>   
            </fieldset>
            <fieldset class="slds-form-element">
            <div class="slds-form-element slds-p-horizontal--small">
              <label class="slds-checkbox--toggle slds-grid">
                <label class="slds-form-element__label" for="SrecCommonwealthProgram">Has {!v.customer.Loan__r.Name} applied for funding through the Commonwealth Solar Rebate Program after 01/01/2010?</label>
                
                <ui:inputCheckbox name="SrecCommonwealthProgram" 
                                  value="{!v.customerInformation.Commonwealth_Solar_Rebate_Program__c }" 
                                  change="{!c.setEquipmentCommonwealthProgram}"/>
                  <span id="toggle-desc" class="slds-checkbox--faux_container " aria-live="assertive">
                  <span class="slds-checkbox--faux"></span>
                  <span class="slds-checkbox--on">Yes</span>
                  <span class="slds-checkbox--off">No</span>
                </span>
              </label>
            </div>   
            </fieldset>                
              <br></br>              
              </div>
            <fieldset aura:id="SrecGeneratorPage" class="slds-form--compound noDisplay">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Generator Type</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Generator_Type__c}" placeholder="{!v.customerInformation.Generator_Type__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Generator Nameplate Capacity (KW DC)</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Generator_Nameplate_Capacity__c}" placeholder="{!v.customerInformation.Generator_Nameplate_Capacity__c}"/>          
                  </div>                                       
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Annual Production (KWH)</label>
                    <ui:inputNumber aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Annual_Production_kWh_kW__c}" placeholder="{!v.customerInformation.Annual_Production_kWh_kW__c}" />          
                  </div>                     
                </div>
                <div class="slds-form-element slds-p-horizontal--small">
                  <label class="slds-form-element__label" for="select-01">MA Facility Sector</label>
                  <div class="slds-form-element__control">
                    <div class="slds-select_container">
                      <select id="select-01" class="slds-select">
                        <option>Select</option>
                        <option>Residential</option>
                        <option>Commercial</option>
                        <option>Government</option>
                      </select>
                    </div>
                  </div>
                </div> 
                <div class="slds-form-element slds-p-horizontal--small">
                  <label class="slds-form-element__label" for="select-01">MA Facility Type</label>
                  <div class="slds-form-element__control">
                    <div class="slds-select_container">
                      <select id="select-01" class="slds-select">
                        <option>Select</option>
                        <option>Agricultural</option>
                        <option>College/University</option>
                        <option>Commercial/Office</option>
                        <option>Community Solar</option>
                        <option>Hospital/Health Care</option>
                        <option>Industrial</option>
                        <option>Mixed Use (commercial and residential)</option>
                        <option>Religious</option>
                        <option>Restaurant/Food Service</option>
                        <option>Retail</option>
                        <option>School (K-12)</option>
                        <option>Federal</option>                                                                        
                        <option>Municipal – K-12 School</option>
                        <option>Municipal / Government / Public</option>
                        <option>State</option>                        
                        <option>State – College / University</option>
                        <option>Multi-family residential (4 or more dwellings units per building)</option>
                        <option>Residential (3 or fewer dwelling units per building)</option>                        
                        <option>Other</option>
                      </select>
                    </div>
                  </div>
                </div>                                 
                </div>                 
            </fieldset>   
            <fieldset aura:id="SrecModulePage" class="slds-form--compound noDisplay">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Manufacturer</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Manufacturer__c}" placeholder="{!v.customerInformation.Module_Manufacturer__c}"/>          
                  </div>                                        
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Model Number</label>
                    <ui:inputNumber aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Module_Model_Number__c}" placeholder="{!v.customerInformation.Module_Model_Number__c}" />          
                  </div>                     
                </div> 
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Power Rating</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Power_Rating__c}" placeholder="{!v.customerInformation.Module_Power_Rating__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Number of Modules</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Number_of_Modules__c}" placeholder="{!v.customerInformation.Number_of_Modules__c}"/>          
                  </div>                                       
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Array Mounting Type</label>
                    <ui:inputText aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Module_Array_Mounting_Type__c}" placeholder="{!v.customerInformation.Module_Array_Mounting_Type__c}" />          
                  </div>                     
                </div> 
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Array Azimuth</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Array_Azimuth__c}" placeholder="{!v.customerInformation.Module_Array_Azimuth__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Array Tilt</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Module_Array_Tilt__c}" placeholder="{!v.customerInformation.Module_Array_Tilt__c}"/>          
                  </div>                                       
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Module Mounting Location</label>
                    <ui:inputText aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Module_Mounting_Location__c}" placeholder="{!v.customerInformation.Module_Mounting_Location__c}" />          
                  </div>                     
                </div>                                                              
                </div>                 
            </fieldset> 
            <fieldset aura:id="SrecInverterPage" class="slds-form--compound noDisplay">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Inverter Manufacturer</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Inverter_Manufacturer__c}" placeholder="{!v.customerInformation.Inverter_Manufacturer__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Number of Inverters</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Number_of_Inverters__c}" placeholder="{!v.customerInformation.Number_of_Inverters__c}"/>          
                  </div>                                       
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Inverter Model Number</label>
                    <ui:inputNumber aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Inverter_Model_Number__c}" placeholder="{!v.customerInformation.Inverter_Model_Number__c}" />          
                  </div>                     
                </div>                                                                           
                </div>                 
            </fieldset>  
            <fieldset aura:id="SrecRemoteMonitoringPage" class="slds-form--compound noDisplay">
              <div class="slds-form-element__group">             
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Remote Monitoring System Vendor</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Remote_Monitoring_System_Vendor__c}" placeholder="{!v.customerInformation.Remote_Monitoring_System_Vendor__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Remote Monitoring System Unique Identifier</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Remote_Monitorin_Systegm_Identifier__c}" placeholder="{!v.customerInformation.Remote_Monitorin_Systegm_Identifier__c}"/>          
                  </div>                                                            
                </div>                                                                           
                </div>                 
            </fieldset> 
            <fieldset aura:id="SrecSolarMeterPage" class="slds-form--compound noDisplay">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Number of Meters</label>
                    <ui:inputNumber aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Number_of_Meters__c}" placeholder="{!v.customerInformation.Number_of_Meters__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Solar Meter Manufacturer</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Solar_Meter_Manufacturer__c}" placeholder="{!v.customerInformation.Solar_Meter_Manufacturer__c}"/>          
                  </div>                                       
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Solar Meter Model</label>
                    <ui:inputNumber aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Solar_Meter_Model__c}" placeholder="{!v.customerInformation.Solar_Meter_Model__c}" />          
                  </div>                     
                </div>
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Solar Meter Serial Number</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Solar_Meter_Serial_Number__c}" placeholder="{!v.customerInformation.Solar_Meter_Serial_Number__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Initial Solar Meter Reading</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Initial_Solar_Meter_Reading__c}" placeholder="{!v.customerInformation.Initial_Solar_Meter_Reading__c}"/>          
                  </div>                                       
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Initial Solar Meter Reading Date</label>
                    <ui:inputDate aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Initial_Solar_Meter_Reading_Date__c}"/>          
                  </div>                     
                </div>                                                                                            
                </div>                                
            </fieldset>  
            <fieldset aura:id="SrecMiscPage" class="slds-form--compound noDisplay">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">CEC Production Tracking System ID Number</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.CEC_Production_Tracking_System_ID_Number__c}" placeholder="{!v.customerInformation.CEC_Production_Tracking_System_ID_Number__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">PowerClerk Application ID</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.PowerClerk_Application_ID__c}" placeholder="{!v.customerInformation.PowerClerk_Application_ID__c}"/>          
                  </div>                                                           
                </div>
                <div class="slds-form-element__row">                
                 <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Estimated On-Site Behind the Meter Load</label>
                    <ui:inputNumber aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Estimated_On_Site_Behind_the_Meter_Load__c}" placeholder="{!v.customerInformation.Estimated_On_Site_Behind_the_Meter_Load__c}" />          
                  </div> 
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Percentage of System Shaded</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Percentage_of_System_Shaded__c}" placeholder="{!v.customerInformation.Percentage_of_System_Shaded__c}"/>          
                  </div>
                  </div>                                                          
                </div>                                                                                                                           
            </fieldset>   
            <fieldset aura:id="SrecInstallationTimeLinePage" class="slds-form--compound noDisplay">
              <div class="slds-form-element__group">
                <div class="slds-form-element__row">
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Contract Execution Date</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Contract_Execution_Date__c}" placeholder="{!v.customerInformation.Contract_Execution_Date__c}"/>          
                  </div>  
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Generator Installation Date</label>
                    <ui:inputText aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Generator_Installation_Date__c}" placeholder="{!v.customerInformation.Generator_Installation_Date__c}"/>          
                  </div>                                                           
                </div>
                <div class="slds-form-element__row">                
                 <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Generator Interconnection Date</label>
                    <ui:inputDate aura:id="moduleNumber" class="slds-input" value="{!v.equipmentUpdate.Generator_Interconnection_Date__c}"/>          
                  </div> 
                  <div class="slds-form-element slds-p-horizontal--small">
                    <label class="slds-form-element__label" for="input-03">Generator Energized/Online Date</label>
                    <ui:inputDate aura:id="moduleType" class="slds-input" value="{!v.equipmentUpdate.Generator_Energized_Online_Date__c}"/>          
                  </div>
                  </div>                                                          
                </div>                                                                                                                           
            </fieldset>                                                                                                                       
              </div>
              <div class="slds-modal__footer">
                <div class="slds-align--absolute-center">
            <fieldset>           
              <legend class="slds-form-element__legend slds-form-element__label"></legend>
              <div class="slds-form-element__control">
                <div class="slds-radio--button-group">
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="srecInterconnectionToggle" onclick="{!c.getSrecInterconnectionPage}" checked="true"/>
                    <label class="slds-radio--button__label" for="srecInterconnectionToggle">
                      <span class="slds-radio--faux">Interconnection / SREC</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="srecGeneratorToggle" onclick="{!c.getGeneratorInformationPage}"/>
                    <label class="slds-radio--button__label" for="srecGeneratorToggle">
                      <span class="slds-radio--faux">Generator Information</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="SrecModuleToggle" onclick="{!c.getModuleInformationPage}"/>
                    <label class="slds-radio--button__label" for="SrecModuleToggle">
                      <span class="slds-radio--faux">Module Information</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="SrecInverterToggle" onclick="{!c.getInverterInformationPage}"/>
                    <label class="slds-radio--button__label" for="SrecInverterToggle">
                      <span class="slds-radio--faux">Inverter Information</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="SrecRemoteMonitoringToggle" onclick="{!c.getRemoteMonitoringInformationPage}"/>
                    <label class="slds-radio--button__label" for="SrecRemoteMonitoringToggle">
                      <span class="slds-radio--faux">Remote Monitoring Information</span>
                    </label>
                  </span>
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="SrecMeterToggle" onclick="{!c.getSolarMeterInformationPage}"/>
                    <label class="slds-radio--button__label" for="SrecMeterToggle">
                      <span class="slds-radio--faux">Solar Meter Information</span>
                    </label>
                  </span>  
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="SrecMiscToggle" onclick="{!c.getMiscInformationPage}" />
                    <label class="slds-radio--button__label" for="SrecMiscToggle">
                      <span class="slds-radio--faux">Miscellaneous Information</span>
                    </label>
                  </span> 
                  <span class="slds-button slds-radio--button">
                    <input type="radio" name="srecPageOptions" id="SrecInstallationTimeLineToggle" onClick="{!c.getInstallationTimeLineInformationPage}"/>
                    <label class="slds-radio--button__label" for="SrecInstallationTimeLineToggle">
                      <span class="slds-radio--faux">Installation Timeline</span>
                    </label>
                  </span>                                                     
                </div>
              </div>
            </fieldset>
            </div>                                                            
                <lightning:button aura:id="saveSrecModalButton" class="slds-button slds-button--brand floatRight marginTopp5" onclick="{!c.saveEquipmentInformation}" label="Save"></lightning:button>
                <lightning:button aura:id="cloaseSrecModalButton" class="slds-button slds-button--brand floatRight marginRight2 marginTopp5" onclick="{!c.closeInterconnectionModal}" label="Close"></lightning:button>
                <ui:spinner aura:id="srecSaveSpinner" class="floatRight" isVisible="false"/>            
              </div>
            </div>
          </div>          
        <div aura:id="modalBackDrop" class="slds-backdrop--open"></div>            
        <!--  _________________________________TASK TABLE ___________________________________ -->    
        <table aura:id="taskTable" class="slds-table slds-table--bordered slds-table--striped  box ">
          <thead>
            <tr class="slds-text-heading--label " >
              <th scope="col"><span class="slds-truncate"><b>Task</b></span></th> 
              <th scope="col"><span class="slds-truncate"><b>Status</b></span></th>              
              <th scope="col"><span class="slds-truncate"><b>Completion Date</b></span></th>              
              <th scope="col"><span aura:id = "viewParentSubTasks" class="slds-truncate"><b>Sub-Tasks</b></span></th>
              </tr>
          </thead>
          <tbody>
 			    <aura:iteration items="{!v.partnerTaskList}" var="task">
                <tr>
                    <th scope="row"> <b>{!task.Name}</b> </th> 
                    <aura:if isTrue="{!task.Status__c == 'Pending'}">                                                                 
                      <th scope="row" class="proximaNovaDataStream"> <b>{!task.Status__c}</b> </th>
                    <aura:set attribute="else">
                      <th scope="row"> <b>{!task.Status__c}</b> </th>
                    </aura:set>                             
                    </aura:if>   
                    <th scope="row"> <b>{!task.Completion_Date__c}</b> </th>
                    <aura:if isTrue="{!task.SubTasks__c}"> 
                        <th>                           
                           <ui:button aura:id="viewButton"
                               label="View"           
                               class=""
                               labelClass="{!task.Id}"          
                               press="{!c.openParentSubTasks}"/>
                           <ui:button aura:id="closeButton"        
                               label="Close"
                               class=""
                               labelClass="{!task.Id}"
                               press="{!c.exitParentSubTasks}"/>
                        </th>
                        <aura:set attribute="else">
                          <th>
                          </th>
                        </aura:set>                              
                    </aura:if>                         
                    <aura:if isTrue="{!task.Name == 'Mechanical Installation'}"> 
                      <th>                           
                       <ui:button aura:id="viewButton"
                         label="Submit"           
                         class=""
                         labelClass="{!task.Id}"          
                         press="{!c.navigateInstallationDocs}"/>
                       </th>
                       <aura:set attribute="else">
                    <aura:if isTrue="{!task.Name == 'Interconnection'}"> 
                      <th>                           
                       <ui:button aura:id="viewButton"
                         label="Submit"           
                         class=""
                         labelClass="{!task.Id}"          
                         press="{!c.openInterconnectionModal}"/>
                       </th>
                       <aura:set attribute="else">
                    <aura:if isTrue="{!task.Name == 'Provide All Customer Information'}"> 
                      <th>                           
                       <ui:button aura:id="viewButton"
                         label="Submit"           
                         class=""
                         labelClass="{!task.Id}"          
                         press="{!c.openCustomerInformation}"/>
                       </th>
                       <aura:set attribute="else">
                        <th>
                          <ui:button disabled="true" />
                        </th>
                      </aura:set>                              
                    </aura:if>    
                      </aura:set>                              
                    </aura:if>     
                      </aura:set>                              
                    </aura:if>                                                                       
                  </tr>                         
            </aura:iteration>             
          </tbody>
        </table>
        <br></br>
        <!--  _________________________________SUB-TASK TABLE ___________________________________ -->                
        <!--<div aura:id="subTaskHeader" class="bwBluePaddingBelow noDisplay"><h3>Sub-Tasks - {!v.parentSubTaskList[0].Parent_Task__r.Name}</h3></div>    -->
		    <table aura:id="subTaskTable" class="slds-table slds-table--bordered slds-table--striped  box noDisplay">                
                      <thead>
                        <tr class="slds-text-heading--label " >
                          <th scope="col"><span class="slds-truncate"><b>Sub-Task</b></span></th> 
                          <th scope="col"><span class="slds-truncate"><b>Status</b></span></th>              
                          <th scope="col"><span class="slds-truncate"><b>Completion Date</b></span></th>              
                          <th scope="col"><span aura:id = "viewParentSubTasks" class="slds-truncate"><b>Sub-Tasks</b></span></th>
                          </tr>
                      </thead>
            		  <tbody>
            			<aura:iteration items="{!v.parentSubTaskList}" var="parentSubTask">
                            <tr>
                                <th scope="row" class="slds-text-align--left bwBlue"> <b>{!parentSubTask.Name}</b></th>                       
                                <th scope="row"> <b>{!parentSubTask.Status__c}</b> </th>
                                <th scope="row"> <b>{!parentSubTask.Completion_Date__c}</b> </th>
                        		<aura:if isTrue="{!parentSubTask.SubTasks__c}">                        
                            		<th>                           
                                       <ui:button aura:id="viewButtonParentSubTask"
                                           label="View"           
                                           class=""
                                           labelClass="{!parentSubTask.Id}"          
                                           press="{!c.openSubTasks}"/>
                                       <ui:button aura:id="closeButtonParentSubTask"        
                                           label="Close"
                                           class=""
                                           labelClass="{!parentSubTask.Id}"
                                           press="{!c.exitSubTasks}"/>
                            		</th>                                                          
                            	<aura:set attribute="else">
                                	<th>
                                    	<ui:button disabled="true" />
                                	</th>
                            	</aura:set> 
                    			</aura:if> 
                    	</tr>
						<aura:if isTrue="{!parentSubTask.SubTasks__c}">                
                            <aura:iteration items="{!v.subTaskList}" var="subTask">
                                <tr>
                                    <th scope="row" class="slds-text-align--left bwTeal"> <b>{!subTask.Name}</b></th>                       
                                    <th scope="row"> <b>{!subTask.Status__c}</b> </th>
                                    <th scope="row"> <b>{!subTask.Completion_Date__c}</b> </th>
                                    <th scope="row"></th>
                                </tr>                    
                            </aura:iteration>                     
           		 	</aura:if>                             
            		</aura:iteration>
            </tbody>
        </table>            
        </div>
        <aura:if isTrue="{!v.licenseType}">          
        <div>
        <br></br>  
        <!--  _________________________________DISBURSAL INFORMATION ___________________________________ -->       
        <div aura:id="completeDisbursals" class="bwBluePaddingBelow slds-scrollable noDisplay"><h3>Completed Disbursals</h3></div>                                               
        <table aura:id="disbursalCompleteTable" class="slds-table slds-table--bordered  slds-table--striped box noDisplay">
          <thead>
            <tr class="slds-text-heading--label " >
              <th scope="col"><span class="slds-truncate"><b>Disbursal</b></span></th>   
              <th scope="col"><span class="slds-truncate"><b>Amount</b></span></th>              
              <th scope="col"><span class="slds-truncate"><b>Status</b></span></th>
              <th scope="col"><span class="slds-truncate"><b>Date</b></span></th>                         
              </tr>
          </thead>
          <tbody>
 			    <aura:iteration items="{!v.completeDisbursalList}" var="disbursal">
              		<tr>
                		<th scope="row"> <b>{!disbursal.Name}</b> </th>
                    	<th scope="row"> <ui:outputCurrency class="proximaNovaDataStream" value="{!disbursal.Amount__c}" /></th>                          
                		<th scope="row"> <b>{!disbursal.Status__c}</b> </th>
                        <th scope="row"> <b>{!disbursal.Date_of_Disbursal__c}</b> </th>    
                  		<td> <div class="slds-form-element">
                    		<label class="slds-checkbox--toggle slds-grid">
                        		<ui:inputCheckBox aura:id="disbursalCheck" 
                                                  name="{!disbursal.Id}" 
                                                  value="{!disbursal.Partner_Confirmation__c}"
                                                  change="{!c.updateDisbursal}"/>
                        		<span id="toggle-desc" class="slds-checkbox--faux_container" aria-live="assertive">
                                <span class="slds-checkbox--faux"></span>
                                <span class="slds-checkbox--on">Confirmed</span>
                                <span class="slds-checkbox--off">Unconfirmed</span>
                        		</span>
                    		</label>
                    	</div>
                		</td>                        
                    </tr>                    
            </aura:iteration>          
          </tbody>
        </table> 
        <br></br>    
        <div aura:id="pendingDisbursals" class="bwBluePaddingBelow slds-scrollable noDisplay"><h3>Pending Disbursals</h3></div>                                
        <table aura:id="disbursalIncompleteTable" class="slds-table slds-table--bordered  slds-table--striped box noDisplay">
          <thead>
            <tr class="slds-text-heading--label " >
              <th scope="col"><span class="slds-truncate"><b>Disbursal</b></span></th>   
              <th scope="col"><span class="slds-truncate"><b>Amount</b></span></th>              
              <th scope="col"><span class="slds-truncate"><b>Status</b></span></th>                        
              </tr>
          </thead>
          <tbody>
 			    <aura:iteration items="{!v.incompleteDisbursalList}" var="disbursal">
              		<tr>
                		<th scope="row"> <b>{!disbursal.Name}</b> </th>
                    	<th scope="row"> <ui:outputCurrency class="proximaNovaDataStream" value="{!disbursal.Amount__c}" /></th>                          
                		<th scope="row"> <b>{!disbursal.Status__c}</b> </th>
                        <th scope="row"> <b>{!disbursal.Date_of_Disbursal__c}</b> </th>                          
                    </tr>                    
            </aura:iteration>          
          </tbody>
        </table>             
   	 </div>
     </aura:if>        
    	<div>
            <br></br>
            <button type="button" class="slds-button slds-button--brand" onclick="{! c.exitCustomerWindow }">Back</button>
    	</div>        
    </div> 
</aura:component>