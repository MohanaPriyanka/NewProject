<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Sizing_Information_Required</fullName>
    <active>true</active>
    <description>A shared solar system should not be able to go to the Acquisition stage without the sizing information filled out.</description>
    <errorConditionFormula>AND(
 $CustomMetadata.Custom_Feature_Enablement__mdt.Autosizing.Feature_is_Enabled__c = true,
 OR ( 
ISBLANK(TEXT(Product__r.Sizing_Method__c )),

AND(
ISPICKVAL(Product__r.Sizing_Method__c, &apos;Project Ratio&apos;),

OR(
ISBLANK(TEXT(Product__r.Customer_Subscription_Type__c)),
AND( 
ISPICKVAL( Product__r.Customer_Subscription_Type__c , &apos;Electricity Cost ($)&apos;),
ISBLANK( Utility_NMC_Tariff__r.Value_of_Net_Metering_Credit__c ) 
),
AND(
ISPICKVAL( Product__r.Customer_Subscription_Type__c , &apos;kWh&apos;),
ISBLANK( Utility_NMC_Tariff__r.Size_Ratio__c)
)
)

)
), ISPICKVAL(Stage__c, &apos;Acquisition&apos;)
)</errorConditionFormula>
    <errorMessage>A shared solar system cannot go to the Acquisition stage without the sizing information filled out.</errorMessage>
</ValidationRule>
