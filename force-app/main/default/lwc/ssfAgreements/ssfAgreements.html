<!--
 - Created by PeterYao on 2/24/2020.
 -->

<!-- Simple Signup Form Agreements -->
<template>
  <div class="slds-var-p-around_medium slds-text-align_center slds-text-heading_large">
    Review and Sign Agreements
  </div>
  <template if:true={isPartner}>
    <h4 class="slds-text-align_center"><b>The subscriber must complete this page themselves.</b></h4>
  </template>
  <template if:true={showCommunitySolarAgreement}>
    <div class="slds-var-m-around_small">
      <p class="small">Click the hyperlinks below to view your community solar agreements:</p>
    </div>
    <div class="slds-var-m-around_medium">
      <template iterator:it={contractDocuments}>
        <p key={it.value.id}>
          <c-ssf-contract-document-link
            contract-id={it.value.id}
            contract-title={it.value.title}
            has-error={it.value.showError}
            onfilepreview={filePreview}>
          </c-ssf-contract-document-link>
        </p>
      </template>
    </div>
  </template>
  <template if:true={showContractDocument}>
    <div style="position:fixed;width:100%;height:100%;z-index: 2;top:0;left:0;background-color: rgba(0,0,0,0.5)">
      <div>
        <p class="slds-text-color_inverse">
          FOR PREVIEW ONLY<br/>Click "Close" to return to the agree page for signature.
        </p>
        <lightning-button label="Close" onclick={hideContractDocument}></lightning-button>
      </div>
      <div style="height: 100%">
        <iframe style="width:100%;height:100%" title="Contract" id="contract_iframe" src={documentUrl}></iframe>
      </div>
    </div>
  </template>
  <div class="slds-var-m-around_small">
    <p class="small">Click the checkboxes below to sign your agreements:</p>
  </div>
  <div style="background-color:#F1F3EF" class="slds-var-p-around_small">
    <template if:true={showDisclosures}>
      <p class="slds-var-m-around_small">
        <lightning-input name="disclosures"
                         type="checkbox"
                         checked={disclosures}
                         label="Check to Consent to Electronic Disclosures"
                         onchange={handleApprovalChecked}>

        </lightning-input>
      </p>
      <p class="small slds-var-m-around_small">
        {disclosureLanguageFirstSegment}<b><a target="_blank" rel="noopener noreferrer" style="color:#1A5FEA"
                                              href={esignDisclosureUrl}>ESIGN Consent Disclosure</a></b>{disclosureLanguageSecondSegment}
      </p>
    </template>
    <template if:true={renderCreditCheckLanguage}>
      <template if:true={showCreditCheck}>
        <p class="small slds-var-m-around_small">
          <lightning-input name="creditCheck"
                           checked={creditCheck}
                           type="checkbox"
                           label={creditCheckLabel}
                           onchange={handleApprovalChecked}>
          </lightning-input>
        </p>
        <template if:true={isFicoUnderwriting}>
          <p class="small slds-var-m-around_small">
            {ficoLanguage}
          </p>
        </template>
        <template if:true={isFinDocsUnderwriting}>
          <p class="small slds-var-m-around_small">
            {finDocsLanguage}
          </p>
        </template>
        <template if:true={isUtilityDataConsentOnly}>
          <p class="small slds-var-m-around_small">
            {utilityDataReviewLanguage}
          </p>
        </template>
      </template>
    </template>
    <template if:true={showPhoneConsent}>
      <p class="slds-var-m-around_small">
        <lightning-input name="phoneConsent"
                         type="checkbox"
                         checked={phoneConsent}
                         label="Check to Give Permission to Use your Phone Number"
                         onchange={handleApprovalChecked}>
        </lightning-input>
      </p>
      <p class="small slds-var-m-around_small">
        {phoneConsentLanguage}
      </p>
    </template>
    <template if:true={showCommunitySolarAgreement}>
      <p class="small slds-var-m-around_small">
        <lightning-input name="communitySolarAgreement"
                         checked={communitySolarAgreement}
                         type="checkbox"
                         label="Check to Sign Community Solar Agreement and CS Disclosure"
                         onchange={handleApprovalChecked}>
        </lightning-input>
      </p>
      <p class="small slds-var-m-around_small">
        <span>{agreementLanguageFirstSegment}</span>
        <template iterator:it={contractDocuments}>
            <span key={it.value.id}>
                <template if:false={it.value.first}> and </template>
                <c-ssf-contract-document-link
                  contract-id={it.value.id}
                  contract-title={it.value.title}
                  has-error={it.value.showError}
                  onfilepreview={filePreview}>
                </c-ssf-contract-document-link>
            </span>
        </template>
        <span> as well as {label.companyShortName}'s <b><a target="_blank" rel="noopener noreferrer"
                                                           style="color:#1A5FEA" href={label.companyPrivacyPolicyLink}>Privacy Policy</a></b>. {agreementLanguageSecondSegment}</span>
      </p>
    </template>
    <div class="slds-grid slds-wrap">
      <div class="slds-size_1-of-3">
      </div>
      <div class="slds-size_1-of-3">
        <div class="slds-grid slds-wrap">
          <div
            class="slds-size_1-of-4 slds-align_absolute-center"
            onclick={handleCarouselPreviewClick}
            data-id="disclosures">
            <lightning-icon icon-name={disclosuresIcon} alternative-text="Preview" size="x-small"></lightning-icon>
          </div>
          <template if:true={renderCreditCheckLanguage}>
            <div
              class="slds-size_1-of-4 slds-align_absolute-center"
              onclick={handleCarouselPreviewClick}
              data-id="creditCheck">
              <lightning-icon icon-name={creditCheckIcon} alternative-text="Preview" size="x-small"></lightning-icon>
            </div>
          </template>
          <div
            class="slds-size_1-of-4 slds-align_absolute-center"
            onclick={handleCarouselPreviewClick}
            data-id="phoneConsent">
            <lightning-icon icon-name={phoneConsentIcon} alternative-text="Preview" size="x-small"></lightning-icon>
          </div>
          <div
            class="slds-size_1-of-4 slds-align_absolute-center"
            onclick={handleCarouselPreviewClick}
            data-id="communitySolarAgreement">
            <lightning-icon icon-name={communitySolarAgreementIcon} alternative-text="Preview"
                            size="x-small"></lightning-icon>
          </div>
        </div>
      </div>
      <div class="slds-size_1-of-3">
      </div>
    </div>
  </div>
  <template if:true={showCommunitySolarAgreement}>
    <p class="slds-var-m-around_small">
      <c-ssf-signature
        label="Sign below"
        required
        help-message="Sign to agree">
      </c-ssf-signature>
    </p>
  </template>
  <div class="slds-grid">
    <div class="slds-size_1-of-2">
      <button class="btn-inverse slds-var-m-around_small slds-float_left" onclick={handleBackButton}>Back</button>
    </div>
    <div class="slds-size_1-of-2">
      <button class="btn slds-var-m-around_small slds-float_right" onclick={continueAgreement}>{continueButtonLabel}
      </button>
    </div>
  </div>
</template>